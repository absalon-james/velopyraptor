OPTIMAL_SYMBOL_IDS = [

    # First 4 are empty. k = 0|1|2|3 not possible
    None, None, None, None,

    # k = 4
    [110, 207, 217, 705, 846, 994, 1224, 1881, 1956, 2882, 3567, 3743, 3877,
     1, 2, 5],

    # k = 5
    [18, 134, 279, 401, 913, 990, 1071, 1381, 1591, 1651, 1715, 2232, 2375,
     2974, 3793, 1, 5, 7, 9, 10],

    # k = 6
    [36, 37, 68, 105, 550, 666, 674, 711, 888, 1082, 1197, 2071, 2102, 2103,
     3625, 3808, 1, 3, 4, 7, 9, 10, 11, 13],

    # k = 7
    [181, 317, 547, 1176, 1382, 1404, 1410, 1477, 1523, 1945, 2041, 2321, 3057,
     3179, 3244, 3408, 0, 8, 10, 12, 18, 19, 20, 22, 23, 25, 26, 27],

    # k = 8
    [18, 134, 279, 401, 913, 990, 1071, 1135, 1151, 1342, 1381, 1411, 1448,
     1591, 1651, 1715, 2750, 2880, 3275, 3793, 1, 5, 7, 9, 10, 11, 12, 15, 16,
     21, 22, 27],

    # k = 9
    [16, 197, 323, 381, 505, 677, 1103, 1159, 1445, 1917, 2109, 2272, 2392,
     2694, 3132, 4265, 4803, 0, 3, 4, 6, 10, 11, 12, 14, 15, 17, 24, 27, 31,
     38, 40, 43, 45, 47, 50],

    # k = 10
    [21, 173, 220, 238, 544, 669, 703, 715, 895, 958, 1125, 1539, 1589, 1629,
     1635, 1746, 2113, 2387, 2828, 2847, 3394, 3952, 0, 1, 2, 4, 5, 6, 7, 9,
     10, 13, 14, 18, 19, 20, 24, 27, 28, 29],

    # k = 11
    [46, 56, 307, 312, 575, 654, 662, 805, 895, 1009, 1131, 1135, 1789, 1806,
     1898, 2066, 2100, 2287, 2807, 3085, 3, 9, 12, 13, 16, 17, 18, 21, 22, 23,
     24, 25, 28, 29, 31, 34, 37, 38, 41, 50, 53, 54, 55, 57],

    # k = 12
    [114, 210, 310, 312, 474, 485, 604, 658, 718, 803, 834, 1370, 1723, 1953,
     2024, 2603, 2645, 2722, 2743, 3411, 3430, 4334, 3, 5, 7, 8, 13, 14, 18,
     19, 20, 22, 25, 28, 29, 30, 33, 34, 36, 38, 43, 45, 46, 47, 48, 50, 54,
     55],

    # k = 13
    [1, 47, 79, 210, 497, 542, 766, 800, 822, 846, 1089, 1397, 1398, 1454,
     1722, 1997, 2078, 2197, 2262, 2296, 2375, 2418, 3660, 4656, 2, 5, 7, 10,
     12, 13, 18, 20, 22, 23, 25, 26, 28, 32, 33, 35, 41, 42, 43, 44, 51, 54,
     55, 57, 58, 59, 60, 62],

    # k = 14
    [94, 138, 420, 796, 859, 1031, 1217, 1358, 1477, 1636, 1648, 1958, 1983,
     1992, 2114, 2488, 2631, 3575, 4655, 4972, 1, 2, 6, 7, 8, 12, 17, 18, 21,
     22, 24, 25, 28, 39, 40, 43, 48, 51, 55, 56, 64, 65, 67, 70, 71, 79, 80,
     82, 87, 90, 95, 96, 97, 98, 99, 101],

    # k = 15
    [46, 56, 249, 307, 312, 575, 654, 805, 895, 1046, 1131, 1135, 1789, 1806,
     1898, 2066, 2100, 2287, 2515, 2607, 2807, 3085, 3348, 4316, 3, 9, 12, 13,
     16, 17, 18, 21, 22, 23, 24, 25, 28, 29, 31, 34, 37, 38, 41, 42, 50, 53,
     54, 55, 57, 58, 62, 64, 70, 73, 75, 80, 84, 86, 87, 89],

    # k = 16
    [178, 219, 308, 534, 539, 728, 953, 956, 1069, 1151, 1217, 1286, 1295,
     1355, 1686, 1705, 1966, 2254, 2685, 2777, 2940, 3012, 3095, 3117, 3772,
     3995, 4020, 4196, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 17, 18, 20, 22, 23, 25,
     26, 27, 30, 35, 36, 39, 41, 50, 51, 52, 53, 56, 61, 63, 64, 74, 79, 80,
     81, 82],

    # k = 17
    [181, 317, 547, 610, 769, 1176, 1404, 1410, 1477, 1514, 1523, 1945, 1980,
     2041, 2163, 2178, 2566, 2871, 3179, 3244, 3831, 4579, 4933, 4968, 0, 8,
     10, 12, 18, 19, 20, 22, 23, 25, 26, 27, 28, 31, 32, 34, 37, 40, 44, 45,
     47, 51, 52, 54, 56, 57, 58, 59, 67, 72, 74, 79, 80, 84, 87, 89, 92, 95,
     96, 104, 105, 109, 110, 113],

    # k = 18
    [110, 207, 217, 705, 846, 933, 994, 1224, 1330, 1670, 1711, 1804, 1881,
     1947, 2059, 2136, 2309, 2479, 2565, 2842, 3271, 3743, 3812, 3877, 4355,
     4479, 1, 2, 5, 7, 8, 10, 11, 12, 14, 15, 16, 19, 20, 22, 23, 24, 33, 34,
     35, 37, 39, 41, 42, 46, 50, 51, 53, 54, 55, 57, 58, 59, 61, 62, 63, 65,
     66, 67, 70, 71, 72, 75, 78, 80, 81, 82],

    # k = 19
    [78, 338, 400, 588, 621, 1060, 1188, 1245, 1703, 1884, 1989, 2095, 2155,
     2489, 2610, 2828, 2976, 3446, 3619, 3713, 3910, 4169, 4318, 4673, 4807, 0,
     1, 3, 8, 9, 13, 14, 17, 20, 24, 27, 32, 34, 36, 37, 38, 44, 46, 47, 49,
     50, 51, 52, 54, 55, 56, 57, 59, 61, 65, 67, 70, 71, 72, 73, 79, 80, 86,
     87, 88, 89, 91, 94, 98, 102, 108, 110, 111, 113, 114, 116],

    # k = 20
    [21, 173, 220, 238, 263, 544, 669, 703, 715, 1125, 1244, 1425, 1539, 1589,
     1629, 1635, 1651, 1757, 1884, 2033, 2113, 2151, 2210, 2218, 2260, 2387,
     2679, 3503, 4021, 4027, 4247, 4538, 0, 1, 2, 4, 5, 6, 7, 9, 10, 13, 14,
     18, 19, 20, 24, 27, 28, 29, 30, 31, 35, 39, 40, 44, 49, 53, 56, 59, 60,
     61, 62, 70, 75, 76, 79, 81, 83, 84, 87, 88, 90, 92, 94, 95, 96, 98, 99,
     102],

    # k = 21
    [22, 87, 381, 499, 515, 734, 744, 781, 1262, 1309, 1369, 1439, 1726, 1728,
     1912, 1949, 2230, 2306, 2331, 2398, 2594, 2663, 2749, 3203, 3214, 3288,
     3382, 3552, 3773, 3829, 3, 4, 5, 9, 10, 12, 13, 16, 18, 19, 21, 24, 25,
     26, 27, 29, 32, 33, 34, 36, 38, 41, 44, 45, 47, 48, 49, 51, 52, 56, 58,
     62, 64, 65, 66, 68, 69, 74, 75, 76, 80, 85, 86, 89, 90, 93, 98, 99, 103,
     104, 105, 106, 107, 112],

    # k = 22
    [36, 37, 68, 105, 125, 188, 550, 643, 666, 674, 711, 888, 984, 1041, 1082,
     1197, 1211, 1234, 1457, 1505, 2071, 2102, 2103, 2236, 2997, 3176, 3332,
     3766, 4013, 4170, 1, 3, 4, 7, 9, 10, 11, 13, 15, 19, 20, 21, 25, 28, 30,
     33, 34, 35, 38, 39, 50, 54, 57, 60, 61, 64, 66, 69, 73, 77, 78, 79, 80,
     81, 83, 89, 92, 93, 94, 96, 98, 102, 103, 107, 108, 112, 114, 115, 118,
     121, 124, 126, 130, 134, 135, 138, 139, 144],

    # k = 23
    [58, 146, 297, 436, 537, 600, 659, 671, 874, 1123, 1126, 1221, 1291, 1349,
     1405, 1670, 1735, 1880, 1919, 2389, 2475, 2656, 2716, 2933, 3016, 3045,
     3438, 4119, 4347, 4527, 1, 5, 8, 15, 17, 18, 19, 20, 23, 25, 28, 30, 31,
     35, 39, 41, 42, 43, 46, 48, 50, 57, 59, 60, 62, 63, 64, 66, 68, 69, 71,
     73, 78, 79, 82, 83, 84, 90, 92, 96, 97, 99, 100, 103, 105, 106, 110, 111,
     112, 124, 125, 128, 129, 130, 131, 132, 134, 136, 138, 140, 141, 142],

    # k = 24
    [18, 56, 170, 652, 1122, 1199, 1311, 1319, 1425, 1877, 2020, 2144, 2211,
     2336, 2642, 2823, 2981, 3194, 3256, 3268, 3379, 3482, 3587, 3775, 4063,
     4099, 4621, 4840, 5, 9, 12, 15, 17, 22, 24, 27, 28, 29, 31, 33, 35, 36,
     37, 38, 42, 43, 44, 45, 48, 51, 52, 55, 58, 67, 68, 70, 73, 75, 77, 81,
     84, 85, 91, 92, 93, 96, 97, 99, 102, 103, 105, 106, 110, 111, 117, 125,
     128, 129, 130, 131, 132, 136, 138, 139, 140, 141, 142, 143, 144, 149,
     151, 152, 153, 157, 159, 161],

    # k = 25
    [94, 138, 796, 909, 916, 1031, 1477, 1492, 1636, 1648, 1713, 1958, 1983,
     1984, 1992, 2114, 2488, 2631, 2808, 3048, 3459, 3575, 3723, 3854, 4210,
     4420, 4655, 4769, 4797, 1, 2, 6, 7, 8, 12, 17, 18, 21, 22, 24, 25, 28,
     31, 39, 40, 43, 48, 51, 55, 56, 64, 65, 67, 70, 71, 79, 82, 87, 90, 95,
     96, 97, 98, 99, 101, 102, 106, 110, 111, 118, 119, 120, 123, 124, 125,
     126, 128, 129, 131, 134, 140, 141, 146, 151, 152, 153, 154, 158, 161, 162,
     163, 165, 169, 171, 172, 173, 177, 180, 182, 183],

    # k = 26
    [16, 19, 323, 524, 676, 682, 695, 941, 1272, 1299, 1318, 1352, 1368, 1547,
     1739, 1838, 1866, 1983, 2794, 2811, 3095, 3139, 3353, 3813, 4583, 4866, 3,
     6, 7, 14, 18, 21, 23, 25, 26, 30, 34, 38, 40, 41, 45, 46, 47, 51, 52, 53,
     55, 56, 59, 61, 64, 70, 71, 72, 73, 74, 75, 76, 77, 79, 83, 84, 85, 86,
     88, 90, 92, 93, 99, 100, 104, 105, 106, 109, 111, 114, 115, 116, 121, 122,
     123, 125, 126, 129, 130, 132, 133, 135, 136, 137, 140, 141, 142, 145, 154,
     155, 158, 161, 162, 163, 164, 165, 168, 173],

    # k = 27
    [86, 269, 300, 450, 490, 652, 822, 859, 866, 867, 919, 929, 962, 1038,
     1237, 1621, 1650, 1654, 1768, 1840, 2980, 3362, 3670, 3983, 4464, 4822, 5,
     7, 8, 13, 14, 16, 18, 21, 22, 23, 25, 26, 29, 30, 32, 37, 41, 42, 44, 45,
     55, 60, 61, 62, 63, 65, 67, 68, 72, 74, 75, 77, 80, 84, 85, 89, 93, 96,
     97, 99, 103, 105, 106, 107, 110, 111, 113, 115, 117, 130, 135, 137, 146,
     147, 148, 150, 152, 154, 156, 157, 158, 160, 163, 164, 165, 167, 171, 173,
     174, 175, 177, 179, 180, 185, 186, 187, 188, 189, 192, 200, 201, 203],

    # k = 28;
    [40, 271, 495, 887, 1021, 1109, 1119, 1274, 1303, 1612, 1772, 1790, 1808,
     1952, 2029, 2281, 2378, 2434, 2517, 3173, 3329, 3868, 4600, 4632, 4720, 0,
     2, 6, 7, 8, 10, 11, 12, 16, 20, 21, 22, 23, 26, 27, 31, 35, 37, 38, 39,
     41, 43, 44, 47, 49, 50, 51, 54, 58, 61, 62, 63, 64, 70, 71, 72, 74, 77,
     78, 83, 84, 91, 92, 93, 96, 98, 99, 100, 101, 103, 104, 107, 117, 118,
     119, 122, 124, 125, 127, 129, 131, 134, 135, 136, 138, 142, 143, 144, 150,
     156, 157, 158, 159, 160, 167, 170, 172, 173, 177, 178, 179, 181, 189, 190,
     193, 194, 203],

    # k = 19
    [16, 198, 245, 365, 466, 816, 832, 855, 976, 1189, 1436, 1524, 1578, 1712,
     1802, 1848, 2339, 2538, 2590, 2888, 2895, 2898, 2982, 3190, 3329, 3407,
     3574, 3695, 3704, 4310, 4442, 4769, 4785, 4909, 0, 1, 3, 6, 9, 12, 13, 15,
     18, 19, 20, 21, 24, 27, 29, 31, 32, 33, 34, 35, 37, 40, 43, 44, 47, 48,
     51, 52, 53, 54, 55, 57, 62, 63, 64, 65, 68, 72, 74, 78, 81, 82, 87, 89,
     91, 92, 95, 98, 101, 102, 108, 112, 114, 121, 122, 123, 124, 129, 131,
     132, 136, 146, 150, 154, 157, 159, 160, 162, 163, 166, 167, 168, 170, 174,
     175, 178, 180, 181, 186, 187, 188, 189],

    # k = 30
    [40, 271, 495, 887, 1021, 1035, 1104, 1109, 1119, 1274, 1303, 1612, 1790,
     1808, 1854, 1952, 2029, 2378, 2434, 2517, 2536, 2717, 3600, 3669, 3737,
     3803, 3868, 4077, 4231, 4449, 4908, 0, 2, 6, 7, 8, 10, 11, 12, 16, 20, 21,
     22, 23, 26, 27, 31, 35, 37, 38, 39, 41, 43, 44, 47, 49, 50, 51, 54, 58,
     61, 62, 63, 64, 69, 70, 71, 72, 74, 77, 78, 83, 84, 91, 92, 93, 96, 98,
     99, 100, 101, 103, 107, 117, 118, 119, 122, 124, 125, 127, 129, 133, 134,
     135, 136, 138, 142, 143, 144, 150, 156, 157, 158, 159, 160, 167, 170, 172,
     173, 177, 179, 181, 189, 190, 193, 194, 199, 203, 204, 205],

    # k = 31
    [278, 302, 423, 432, 449, 529, 707, 736, 1000, 1086, 1198, 1619, 1638,
     1697, 1716, 1799, 1990, 2416, 2653, 2859, 2898, 2927, 3116, 3215, 3488,
     3531, 3563, 3635, 3707, 4070, 4351, 4737, 4793, 0, 3, 5, 6, 8, 9, 10, 13,
     14, 15, 16, 17, 22, 24, 27, 29, 30, 34, 35, 36, 40, 41, 42, 45, 47, 55,
     56, 57, 59, 63, 64, 65, 68, 69, 70, 71, 73, 74, 76, 77, 80, 81, 82, 83,
     84, 85, 88, 93, 96, 99, 104, 106, 112, 113, 118, 120, 121, 122, 123, 124,
     126, 130, 131, 133, 134, 135, 136, 138, 142, 143, 147, 154, 156, 157, 158,
     161, 164, 165, 169, 170, 171, 175, 176, 177, 179, 180, 182, 190, 191, 195,
     197],

    # k = 32
    [361, 457, 562, 622, 919, 974, 975, 1015, 1017, 1057, 1220, 1242, 1285,
     1338, 1377, 1768, 1771, 1786, 1823, 2126, 2645, 2707, 3005, 3007, 3242,
     3672, 3961, 4213, 4532, 0, 2, 3, 7, 8, 9, 10, 11, 12, 14, 17, 18, 19, 20,
     21, 22, 26, 27, 29, 31, 33, 34, 35, 37, 39, 40, 42, 43, 44, 46, 48, 50,
     53, 58, 61, 65, 67, 70, 72, 74, 77, 78, 81, 82, 83, 87, 90, 95, 98, 99,
     101, 103, 105, 106, 109, 111, 117, 125, 128, 137, 140, 142, 143, 147, 148,
     151, 152, 153, 155, 156, 159, 160, 166, 168, 170, 171, 173, 175, 176, 180,
     183, 184, 188, 189, 191, 194, 198, 201, 205, 207, 209, 211, 212, 214, 215,
     217, 218, 223, 229],

    # k = 33
    [94, 110, 146, 166, 337, 469, 938, 1135, 1137, 1228, 1362, 1450, 1522,
     1558, 1607, 1704, 1820, 1833, 2089, 2194, 2239, 2383, 2439, 2451, 2544,
     2680, 2714, 2737, 2901, 2907, 3057, 3822, 3826, 4146, 4177, 4237, 4918,
     4999, 0, 1, 3, 5, 7, 8, 12, 14, 15, 16, 21, 22, 30, 31, 33, 36, 37, 41,
     42, 43, 45, 48, 51, 52, 56, 57, 58, 59, 61, 65, 70, 71, 74, 75, 77, 78,
     80, 83, 86, 87, 89, 91, 96, 97, 102, 105, 108, 113, 114, 115, 117, 118,
     119, 124, 127, 130, 132, 134, 135, 137, 140, 145, 152, 153, 154, 155, 156,
     157, 163, 165, 167, 168, 172, 175, 176, 177, 178, 182, 185, 187, 194, 197,
     199, 200, 201, 202, 203, 204, 206, 210, 213, 214, 216, 217],

    # k = 34
    [6, 247, 313, 351, 397, 555, 587, 708, 730, 731, 830, 929, 975, 1025, 1139,
     1281, 1463, 1491, 1545, 1600, 1757, 1758, 2007, 2068, 2086, 2117, 2236,
     2517, 2673, 2715, 2949, 2962, 3230, 3314, 3585, 3946, 4719, 1, 2, 5, 7,
     13, 14, 15, 16, 18, 19, 20, 23, 25, 26, 28, 30, 32, 34, 37, 42, 43, 44,
     45, 50, 53, 57, 59, 60, 63, 64, 65, 66, 67, 72, 73, 74, 78, 79, 80, 83,
     84, 85, 88, 91, 94, 95, 96, 97, 100, 104, 108, 109, 110, 111, 112, 114,
     116, 120, 121, 123, 126, 130, 137, 139, 140, 143, 144, 147, 148, 152, 154,
     155, 156, 162, 166, 167, 169, 170, 171, 172, 173, 174, 175, 182, 183, 184,
     189, 193, 194, 196, 197, 200, 202, 206, 207, 208, 209, 216, 219],

    # k = 35
    [18, 134, 279, 401, 819, 913, 990, 1071, 1135, 1151, 1342, 1344, 1381,
     1411, 1448, 1591, 1651, 1715, 1784, 2030, 2297, 2375, 2406, 2562, 2668,
     2750, 2880, 2923, 2974, 3144, 3275, 3631, 3689, 3793, 4412, 4839, 1, 5, 7,
     9, 10, 11, 12, 15, 16, 21, 22, 27, 28, 35, 37, 40, 41, 42, 43, 44, 45, 47,
     53, 54, 55, 56, 57, 60, 62, 64, 66, 67, 70, 72, 75, 76, 79, 81, 82, 84,
     85, 88, 89, 92, 93, 94, 95, 97, 98, 101, 102, 103, 105, 106, 107, 109,
     110, 112, 116, 119, 120, 121, 122, 124, 125, 127, 131, 136, 141, 142, 145,
     146, 148, 151, 154, 156, 157, 161, 162, 164, 165, 166, 167, 168, 173, 174,
     177, 180, 185, 187, 188, 189, 190, 192, 194, 198, 201, 202, 206, 214, 219,
     222, 223, 226],

    # k = 36
    [16, 198, 245, 365, 466, 816, 832, 855, 976, 1189, 1258, 1436, 1524, 1578,
     1712, 1802, 1848, 2339, 2538, 2590, 2888, 2895, 2898, 3099, 3190, 3265,
     3309, 3407, 3695, 3730, 3783, 3903, 3970, 4785, 4865, 0, 1, 3, 6, 9, 12,
     13, 15, 18, 19, 20, 21, 24, 27, 29, 31, 32, 33, 34, 35, 37, 40, 43, 44,
     47, 48, 51, 52, 53, 54, 55, 57, 62, 63, 64, 65, 68, 72, 74, 78, 81, 82,
     85, 87, 91, 92, 95, 98, 101, 102, 105, 112, 114, 120, 121, 122, 123, 126,
     129, 131, 132, 136, 146, 150, 154, 157, 159, 160, 162, 163, 166, 167, 168,
     170, 173, 174, 175, 178, 180, 181, 182, 186, 187, 188, 189, 194, 200, 204,
     208, 215, 217, 220, 224, 225, 226, 227, 228, 229, 231, 233, 236, 239, 240,
     241, 249, 252, 258, 262, 263],

    # k = 37
    [12, 77, 181, 183, 232, 396, 465, 545, 635, 772, 776, 1371, 1381, 1410,
     1564, 1672, 1941, 2027, 2510, 2810, 3125, 3145, 3514, 3567, 3830, 4110,
     4268, 4369, 4522, 4645, 4912, 1, 2, 3, 11, 13, 14, 20, 24, 26, 30, 32, 33,
     35, 36, 38, 39, 42, 43, 46, 48, 49, 50, 51, 52, 54, 56, 58, 59, 63, 65,
     67, 69, 70, 72, 75, 76, 78, 79, 81, 83, 84, 86, 88, 90, 92, 96, 99, 100,
     102, 111, 113, 116, 117, 118, 120, 122, 124, 125, 126, 131, 133, 134, 136,
     137, 138, 141, 142, 143, 147, 155, 160, 161, 163, 164, 167, 169, 170, 171,
     172, 174, 175, 176, 177, 178, 179, 180, 182, 184, 185, 186, 190, 191, 192,
     195, 196, 199, 201, 203, 207, 208, 209, 211, 213, 215, 216, 217, 220, 221,
     225, 228, 229, 230, 233, 234, 236, 237, 238],

    # k = 38
    [74, 282, 297, 329, 335, 435, 641, 681, 731, 863, 1025, 1120, 1733, 1770,
     1807, 1888, 2474, 2710, 2734, 2843, 2875, 3202, 3390, 3438, 3692, 3907,
     3964, 4333, 4672, 4812, 4872, 4963, 1, 2, 4, 6, 8, 9, 12, 14, 16, 18, 20,
     22, 25, 26, 29, 31, 33, 37, 38, 41, 43, 45, 46, 48, 49, 50, 51, 55, 56,
     58, 61, 63, 64, 65, 66, 67, 71, 72, 76, 77, 78, 79, 80, 82, 90, 92, 94,
     95, 98, 99, 105, 108, 109, 110, 115, 117, 119, 120, 121, 124, 128, 129,
     130, 131, 132, 135, 141, 145, 146, 147, 149, 154, 155, 156, 157, 158, 164,
     167, 168, 170, 172, 173, 175, 176, 178, 181, 183, 187, 188, 189, 190, 191,
     195, 196, 199, 201, 203, 209, 211, 216, 223, 224, 229, 230, 231, 232, 234,
     239, 240, 243, 244, 246, 247, 249, 250, 251, 252, 253, 258, 260],

    # k = 39
    [143, 150, 211, 295, 319, 367, 507, 535, 625, 728, 790, 807, 974, 1001,
     1145, 1202, 1239, 1247, 1383, 1619, 1875, 2058, 2087, 2417, 2559, 2579,
     2581, 2846, 2935, 3028, 3455, 3609, 3721, 4027, 4206, 4382, 4680, 4780, 1,
     2, 5, 8, 11, 19, 21, 22, 23, 26, 32, 34, 35, 37, 38, 39, 40, 42, 43, 44,
     45, 49, 50, 51, 55, 61, 64, 65, 68, 70, 80, 91, 93, 97, 98, 100, 101, 102,
     104, 109, 110, 116, 117, 118, 119, 120, 122, 125, 126, 133, 138, 144, 145,
     147, 148, 153, 154, 160, 161, 163, 164, 169, 170, 177, 178, 179, 186, 193,
     197, 199, 201, 202, 207, 209, 210, 215, 217, 219, 220, 222, 226, 229, 230,
     231, 232, 233, 239, 242, 243, 245, 250, 251, 252, 254, 257, 260, 262, 265,
     266, 272, 274, 279, 281, 282, 283, 284, 287, 288, 292, 293, 296, 297, 298,
     302, 303, 304, 305, 306],

    # k = 40
    [325, 352, 400, 1098, 1379, 1382, 1442, 1493, 1626, 1802, 2128, 2229, 2726,
     2876, 2992, 3002, 3105, 3161, 3381, 3443, 3556, 3738, 3858, 4353, 4423,
     4457, 4471, 0, 5, 7, 12, 18, 21, 22, 24, 29, 30, 31, 32, 33, 35, 36, 38,
     41, 46, 48, 50, 51, 53, 55, 62, 72, 74, 77, 78, 79, 82, 83, 85, 86, 87,
     88, 91, 92, 93, 94, 96, 97, 99, 104, 105, 110, 112, 117, 118, 125, 126,
     128, 130, 135, 139, 141, 150, 154, 155, 157, 159, 160, 164, 166, 168, 170,
     171, 176, 179, 180, 181, 182, 184, 185, 189, 190, 192, 195, 199, 202, 204,
     206, 207, 208, 210, 211, 213, 214, 215, 220, 221, 225, 227, 228, 232, 233,
     234, 237, 240, 241, 244, 245, 246, 250, 252, 253, 259, 263, 264, 265, 266,
     269, 272, 273, 275, 279, 283, 285, 286, 290, 295, 296, 299, 300, 301, 302,
     303, 306, 307, 309, 311, 313, 315, 318],

    # k = 41
    [94, 138, 420, 796, 859, 909, 916, 1031, 1217, 1358, 1477, 1492, 1636,
     1713, 1958, 1983, 1992, 2114, 2623, 2631, 2808, 3005, 3048, 3459, 3854,
     4482, 4655, 4769, 4797, 1, 2, 6, 7, 8, 12, 17, 18, 21, 22, 24, 25, 28, 31,
     39, 40, 43, 48, 51, 55, 56, 64, 65, 67, 70, 71, 79, 80, 82, 87, 90, 95,
     96, 97, 98, 99, 101, 102, 106, 109, 110, 111, 118, 119, 120, 123, 124,
     125, 126, 128, 129, 131, 134, 140, 141, 146, 147, 151, 152, 153, 154, 158,
     161, 162, 163, 165, 169, 171, 172, 177, 180, 182, 183, 184, 185, 189, 192,
     196, 197, 198, 199, 201, 205, 209, 215, 217, 218, 220, 221, 223, 225, 227,
     228, 230, 231, 232, 235, 239, 240, 242, 243, 248, 252, 253, 256, 257, 262,
     263, 266, 267, 270, 273, 275, 278, 279, 281, 282, 284, 286, 288, 289, 290,
     292, 294, 295, 296, 307, 313, 317, 319, 320, 321, 325, 329, 330],

    # k = 42
    [6, 313, 351, 397, 555, 587, 730, 731, 830, 975, 1025, 1139, 1339, 1491,
     1600, 1648, 1757, 1758, 2007, 2086, 2117, 2219, 2236, 2259, 2517, 2715,
     3020, 3314, 3397, 3784, 3863, 4054, 4085, 4227, 4575, 4655, 4799, 1, 2, 5,
     7, 13, 14, 15, 16, 18, 19, 20, 23, 25, 26, 28, 30, 32, 34, 37, 42, 43, 44,
     45, 50, 53, 57, 59, 60, 63, 64, 65, 66, 67, 72, 73, 74, 78, 79, 80, 83,
     84, 85, 88, 91, 94, 95, 96, 97, 100, 104, 108, 109, 110, 111, 112, 114,
     116, 120, 121, 126, 130, 133, 134, 136, 137, 139, 140, 141, 143, 144, 147,
     148, 150, 152, 154, 155, 156, 162, 167, 169, 170, 171, 172, 174, 175, 182,
     183, 184, 189, 190, 193, 194, 196, 200, 202, 206, 207, 208, 209, 216, 219,
     222, 224, 226, 227, 230, 233, 236, 238, 242, 243, 245, 253, 257, 259, 261,
     266, 269, 272, 273, 274, 275, 277, 280, 282, 286, 287, 289, 290, 291,
     294],

    # k = 43
    [86, 269, 300, 652, 822, 859, 866, 867, 919, 962, 1038, 1237, 1621, 1654,
     1768, 1840, 1913, 2049, 2099, 2416, 2478, 2980, 3141, 3664, 3681, 3983,
     4470, 4489, 4711, 4822, 5, 7, 8, 13, 14, 16, 18, 21, 22, 23, 25, 26, 29,
     30, 32, 37, 41, 42, 44, 45, 55, 60, 61, 62, 63, 65, 67, 68, 72, 74, 75,
     77, 80, 84, 85, 89, 91, 93, 96, 97, 99, 103, 105, 106, 107, 110, 111, 115,
     117, 130, 137, 138, 145, 146, 147, 148, 150, 152, 154, 156, 157, 158, 160,
     163, 164, 165, 167, 171, 173, 174, 175, 177, 179, 180, 185, 186, 187, 188,
     189, 192, 200, 201, 203, 208, 211, 214, 216, 227, 229, 230, 231, 234, 240,
     245, 246, 247, 248, 252, 253, 256, 259, 260, 262, 264, 265, 268, 271, 275,
     276, 278, 280, 284, 285, 286, 287, 288, 290, 292, 294, 295, 297, 303, 306,
     307, 309, 312, 313, 314, 315, 317, 319, 320, 323, 327, 334, 335, 337, 339,
     342, 343, 348, 350],

    # k = 44
    [18, 134, 279, 401, 819, 990, 1071, 1135, 1151, 1342, 1344, 1411, 1448,
     1591, 1651, 1784, 1955, 2030, 2232, 2297, 2344, 2406, 2562, 2656, 2750,
     2880, 2974, 3275, 3425, 4337, 4412, 1, 5, 7, 9, 10, 11, 12, 15, 16, 21,
     22, 27, 28, 35, 37, 40, 41, 42, 43, 44, 45, 47, 53, 54, 55, 56, 57, 60,
     62, 64, 66, 67, 70, 72, 75, 76, 79, 81, 82, 84, 85, 88, 89, 92, 93, 94,
     95, 97, 98, 101, 102, 103, 105, 106, 107, 109, 110, 112, 116, 119, 120,
     121, 122, 124, 125, 127, 131, 136, 141, 142, 145, 146, 148, 151, 154, 156,
     157, 161, 162, 164, 165, 166, 167, 168, 173, 177, 180, 185, 186, 187, 188,
     189, 190, 192, 194, 198, 201, 202, 203, 204, 206, 214, 215, 219, 222, 223,
     226, 230, 232, 233, 234, 238, 241, 245, 246, 248, 251, 253, 255, 257, 258,
     259, 265, 266, 270, 271, 274, 275, 278, 285, 286, 289, 291, 294, 295, 297,
     298, 299, 304, 305, 306, 308, 316, 318, 320],

    # k = 45
    [94, 110, 146, 166, 337, 469, 523, 938, 997, 1135, 1228, 1362, 1558, 1607,
     1704, 1820, 1833, 1836, 2089, 2116, 2239, 2294, 2451, 2478, 2544, 2631,
     2680, 2714, 2779, 2901, 3057, 3109, 3822, 3826, 4051, 4177, 4237, 4275,
     4820, 0, 1, 3, 5, 7, 8, 12, 14, 15, 16, 21, 22, 30, 31, 33, 36, 37, 41,
     42, 43, 45, 48, 51, 52, 56, 57, 58, 59, 61, 65, 70, 71, 74, 75, 77, 78,
     80, 83, 86, 87, 89, 91, 96, 97, 102, 103, 105, 113, 114, 117, 118, 119,
     127, 129, 130, 132, 134, 135, 137, 140, 145, 152, 154, 155, 156, 157, 163,
     165, 167, 168, 172, 175, 176, 177, 178, 182, 185, 187, 194, 197, 199, 200,
     201, 202, 203, 204, 206, 210, 213, 214, 216, 217, 221, 223, 224, 225, 227,
     230, 233, 234, 236, 242, 251, 253, 254, 256, 257, 260, 262, 263, 264, 271,
     272, 275, 279, 284, 285, 288, 290, 292, 293, 294, 295, 297, 299, 300, 302,
     306, 307, 309, 311, 313, 316, 319, 325, 326, 328, 331, 332, 333, 334],

    # k = 46
    [114, 241, 267, 309, 347, 403, 470, 715, 908, 1070, 1123, 1219, 1243, 1268,
     1463, 1474, 1724, 1811, 1909, 2065, 2175, 2188, 2355, 2466, 2599, 2791,
     2918, 2995, 3031, 3043, 3472, 3583, 4124, 4187, 4440, 4970, 1, 2, 3, 5, 6,
     9, 10, 11, 13, 14, 20, 21, 22, 26, 28, 29, 32, 33, 34, 35, 37, 38, 40, 42,
     43, 49, 50, 51, 52, 54, 56, 57, 58, 61, 62, 67, 68, 69, 72, 78, 79, 85,
     86, 87, 90, 94, 96, 97, 101, 102, 103, 104, 105, 107, 108, 111, 116, 117,
     118, 121, 122, 124, 126, 131, 132, 135, 138, 139, 142, 148, 149, 150, 151,
     154, 155, 156, 158, 159, 160, 162, 164, 167, 169, 172, 174, 178, 183, 187,
     188, 190, 192, 193, 194, 195, 198, 199, 201, 203, 206, 209, 210, 212, 213,
     215, 18, 219, 220, 228, 240, 242, 245, 246, 248, 250, 251, 252, 253, 257,
     258, 260, 261, 262, 263, 265, 266, 269, 271, 273, 275, 276, 280, 283, 287,
     295, 298, 299, 301, 303, 305, 306, 308, 311, 316, 317, 318, 319, 323,
     326],

    # k = 47
    [114, 241, 267, 309, 347, 403, 470, 715, 908, 1070, 1123, 1219, 1243, 1463,
     1474, 1616, 1724, 1811, 1828, 2065, 2175, 2355, 2466, 3020, 3031, 3394,
     3550, 4337, 4431, 4440, 4591, 4717, 4720, 4970, 1, 2, 3, 5, 6, 9, 10, 11,
     13, 14, 20, 21, 22, 26, 28, 29, 32, 33, 34, 35, 37, 38, 40, 42, 43, 49,
     50, 51, 52, 54, 56, 57, 58, 61, 62, 67, 68, 69, 72, 78, 79, 85, 86, 87,
     90, 94, 96, 97, 100, 101, 102, 103, 104, 105, 107, 108, 111, 116, 117,
     118, 121, 122, 124, 126, 131, 132, 135, 138, 139, 142, 147, 148, 149, 150,
     151, 154, 155, 156, 158, 159, 160, 162, 164, 167, 169, 172, 174, 178, 183,
     187, 188, 190, 192, 193, 194, 195, 198, 199, 201, 203, 206, 209, 210, 212,
     213, 215, 218, 219, 220, 228, 238, 240, 242, 246, 248, 250, 251, 252, 253,
     257, 258, 261, 262, 263, 264, 265, 266, 269, 270, 271, 273, 275, 276, 280,
     283, 284, 287, 295, 298, 299, 301, 303, 305, 306, 308, 311, 316, 317, 318,
     319, 323, 326, 327, 329],

    # k = 48
    [33, 69, 96, 103, 229, 458, 469, 473, 636, 1314, 1350, 1566, 1635, 1722,
     1748, 1755, 1777, 2206, 2246, 2619, 2775, 2816, 2825, 2997, 3074, 3806,
     3818, 3929, 4981, 2, 3, 4, 5, 6, 9, 13, 14, 15, 16, 21, 23, 25, 28, 29,
     31, 34, 36, 38, 40, 43, 45, 49, 51, 52, 53, 57, 60, 61, 62, 66, 67, 71,
     73, 75, 77, 79, 80, 82, 83, 84, 87, 90, 91, 94, 97, 100, 101, 105, 107,
     109, 110, 122, 124, 125, 127, 128, 129, 131, 132, 133, 134, 136, 138, 139,
     143, 145, 149, 150, 152, 156, 160, 169, 175, 176, 179, 182, 183, 184, 185,
     187, 189, 191, 197, 201, 204, 205, 206, 210, 217, 220, 221, 223, 224, 225,
     227, 235, 236, 238, 239, 243, 245, 246, 247, 248, 249, 250, 251, 253, 254,
     258, 259, 260, 261, 267, 268, 270, 271, 272, 273, 276, 278, 279, 281, 282,
     288, 291, 293, 294, 297, 301, 306, 314, 317, 319, 321, 323, 325, 326, 327,
     329, 330, 331, 333, 334, 335, 336, 339, 340, 341, 343, 344, 345, 346, 351,
     353, 360, 362, 363, 367, 368, 371, 376],

    # k = 49
    [207, 292, 460, 529, 787, 827, 1066, 1145, 1338, 1468, 1478, 1511, 1608,
     2028, 2037, 2560, 2885, 3260, 3490, 3568, 3690, 3805, 4191, 4204, 4290,
     4373, 4680, 2, 3, 4, 6, 7, 9, 10, 11, 12, 14, 15, 16, 17, 19, 21, 22, 25,
     28, 29, 35, 36, 37, 38, 39, 43, 47, 48, 51, 52, 53, 55, 60, 66, 70, 71,
     72, 76, 77, 80, 83, 84, 85, 86, 91, 92, 95, 97, 102, 104, 105, 106, 111,
     113, 115, 116, 117, 121, 122, 127, 128, 129, 130, 132, 134, 136, 139, 140,
     141, 142, 146, 147, 150, 153, 155, 157, 158, 161, 162, 164, 165, 166, 168,
     170, 173, 178, 180, 181, 183, 184, 185, 187, 191, 193, 194, 197, 198, 199,
     204, 205, 208, 210, 212, 214, 215, 218, 220, 221, 223, 224, 225, 228, 229,
     230, 232, 234, 235, 237, 238, 241, 242, 243, 244, 252, 257, 259, 260, 261,
     269, 272, 273, 275, 279, 280, 283, 289, 295, 301, 302, 303, 305, 306, 308,
     312, 314, 315, 316, 318, 323, 326, 327, 329, 330, 331, 336, 337, 338, 339,
     342, 344, 345, 346, 353, 354, 355, 356, 357, 359, 360, 362],

    # k = 50
    [271, 296, 411, 649, 787, 963, 1059, 1324, 1399, 1481, 1555, 1701, 2000,
     2302, 2447, 2490, 2813, 2832, 2859, 2914, 2975, 3200, 3253, 3410, 4166,
     4380, 4385, 4495, 4765, 0, 1, 2, 8, 14, 15, 18, 19, 26, 27, 33, 39, 42,
     43, 44, 45, 47, 48, 50, 52, 58, 59, 60, 61, 65, 66, 68, 69, 70, 74, 76,
     78, 79, 81, 82, 83, 85, 87, 88, 89, 91, 92, 95, 96, 99, 101, 102, 104,
     107, 110, 115, 116, 117, 120, 125, 126, 127, 128, 129, 130, 134, 135, 138,
     139, 140, 141, 142, 150, 153, 154, 156, 160, 162, 163, 170, 171, 174, 177,
     178, 180, 185, 188, 189, 192, 195, 201, 202, 203, 204, 208, 209, 211, 213,
     215, 219, 220, 224, 229, 230, 231, 234, 239, 240, 245, 247, 248, 251, 253,
     254, 259, 263, 265, 267, 268, 270, 272, 276, 279, 280, 281, 283, 285, 287,
     289, 290, 291, 292, 294, 298, 301, 304, 306, 307, 308, 309, 311, 312, 316,
     317, 319, 324, 325, 326, 328, 331, 333, 335, 336, 338, 340, 341, 349, 355,
     358, 359, 360, 362, 363, 369, 375, 376, 381, 383, 384, 385, 387, 389, 391,
     393, 394, 395]
]


class OptimalEsiException(Exception):
    """
    Exception indicating there was an issue retrieving and optimal esi
    """

    def __init__(self, message):
        """
        Constructor, simply calls super on parent class

        Arguments:
        message -- String message
        """
        super(OptimalEsiException, self).__init__(message)


def get_esi(k, j):

    """
    Returns the j'th optimal esi for k

    Arguments:
    k -- Integer k - k paramter of a raptor encoding
    j -- Integer j Jth element for that sequence
    """

    if k < len(OPTIMAL_SYMBOL_IDS):
        sequence = OPTIMAL_SYMBOL_IDS[k]
        if j < len(sequence):
            return sequence[j]
        else:
            raise OptimalEsiException(
                "The %s'th optimal esi was requested for k = %s when only %s"
                " esi's are available." % (j, k, len(sequence))
            )
    else:
        raise OptimalEsiException(
            "Optimal esi's were requested for k = %s.  Only the first %s "
            "optimal esi sequences are computed."
            % (k, len(OPTIMAL_SYMBOL_IDS))
        )
